{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "data": {
    "url": "https://raw.githubusercontent.com/ChaiKeRou/3179/main/data/crude_death_age_gender.csv"
  },
  "background": null,
  "transform": [
    {
      "calculate": "datum.Sex == 'Female' ? 'Female' : 'Male'",
      "as": "gender"
    },
    {
      "calculate": "datum.Sex == 'Female' ? -datum.Deaths : datum.Deaths",
      "as": "Deaths_adjusted"
    }
  ],
  "params": [
    {
      "name": "sex_highlight",
      "select": {
        "type": "point",
        "on": "mouseover",
        "fields": [
          "gender"
        ]
      }
    }
  ],
  "spacing": 0,
  "hconcat": [
    {
      "transform": [
        {
          "filter": "datum.gender == 'Male'"
        }
      ],
      "title": {
        "text": "Male",
        "color": "#2f88a6",
        "font": "Outfit",
        "fontSize": 14,
        "fontWeight": 700
      },
      "width": 180,
      "height": 447,
      "mark": "bar",
      "encoding": {
        "y": {
          "field": "Age group",
          "sort": [
            ">= 85",
            "80-84",
            "75-79",
            "70-74",
            "65-69",
            "60-64",
            "55-59",
            "50-54",
            "45-49",
            "40-44",
            "35-39",
            "30-34",
            "25-29",
            "20-24",
            "15-19",
            "10-14",
            "5-9",
            "0-4"
          ],
          "axis": null
        },
        "x": {
          "aggregate": "sum",
          "field": "Deaths_adjusted",
          "title": "Death Cases",
          "sort": "descending",
          "axis": {
            "format": "s",
            "labelAlign": "center",
            "titleFont": "Outfit",
            "labelFont": "Outfit",
            "titleFontWeight": 700,
            "labelFontWeight": 200,
            "titleFontSize": 12,
            "labelFontSize": 10,
            "titlePadding": 10
          },
          "scale": {
            "domain": [
              0,
              20000
            ]
          }
        },
        "color": {
          "field": "gender",
          "scale": {
            "range": [
              "#e30133",
              "#2f88a6"
            ]
          },
          "legend": null
        },
        "opacity": {
          "condition": {
            "param": "sex_highlight",
            "value": 1
          },
          "value": 0.2
        },
        "tooltip": [
          {
            "field": "Age group",
            "title": "Age Range",
            "type": "ordinal"
          },
          {
            "field": "gender",
            "title": "Gender",
            "type": "nominal"
          },
          {
            "field": "Deaths",
            "title": "Death Case",
            "type": "quantitative",
            "format": ","
          },
          {
            "field": "total_deaths",
            "title": "Total Death Case",
            "type": "quantitative",
            "format": ","
          }
        ]
      }
    },
    {
      "width": 35,
      "height": 447,
      "view": {
        "stroke": null
      },
      "mark": {
        "type": "text",
        "align": "center",
        "font": "Outfit",
        "fontSize": 12,
        "fontWeight": 300
      },
      "encoding": {
        "y": {
          "field": "Age group",
          "sort": [
            ">= 85",
            "80-84",
            "75-79",
            "70-74",
            "65-69",
            "60-64",
            "55-59",
            "50-54",
            "45-49",
            "40-44",
            "35-39",
            "30-34",
            "25-29",
            "20-24",
            "15-19",
            "10-14",
            "5-9",
            "0-4"
          ],
          "axis": null
        },
        "text": {
          "field": "Age group"
        }
      }
    },
    {
      "layer": [
        {
          "transform": [
            {
              "filter": "datum.gender == 'Female'"
            }
          ],
          "title": {
            "text": "Female",
            "color": "#e30133",
            "font": "Outfit",
            "fontSize": 14,
            "fontWeight": 700
          },
          "mark": "bar",
          "width": 180,
          "height": 447,
          "encoding": {
            "y": {
              "field": "Age group",
              "sort": [
                ">= 85",
                "80-84",
                "75-79",
                "70-74",
                "65-69",
                "60-64",
                "55-59",
                "50-54",
                "45-49",
                "40-44",
                "35-39",
                "30-34",
                "25-29",
                "20-24",
                "15-19",
                "10-14",
                "5-9",
                "0-4"
              ],
              "axis": null
            },
            "x": {
              "aggregate": "sum",
              "field": "Deaths_adjusted",
              "title": "Death Cases",
              "axis": {
                "labelExpr": "datum.value * -1/1000 + 'k'",
                "labelLimit": 20,
                "titleFont": "Outfit",
                "labelFont": "Outfit",
                "titleFontWeight": 700,
                "labelFontWeight": 200,
                "titleFontSize": 12,
                "labelFontSize": 10,
                "titlePadding": 10
              },
              "scale": {
                "domain": [
                  -20000,
                  0
                ]
              },
              "sort": "descending"
            },
            "color": {
              "field": "gender",
              "scale": {
                "range": [
                  "#e30133",
                  "#2f88a6"
                ]
              },
              "legend": null
            },
            "opacity": {
              "condition": {
                "param": "sex_highlight",
                "value": 1
              },
              "value": 0.2
            },
            "tooltip": [
              {
                "field": "Age group",
                "title": "Age Range",
                "type": "ordinal"
              },
              {
                "field": "gender",
                "title": "Gender",
                "type": "nominal"
              },
              {
                "field": "Deaths",
                "title": "Death Case",
                "type": "quantitative",
                "format": ","
              },
              {
                "field": "total_deaths",
                "title": "Total Death Case",
                "type": "quantitative",
                "format": ","
              }
            ]
          }
        }
      ]
    }
  ],
  "config": {
    "view": {
      "stroke": null
    },
    "axis": {
      "grid": false
    }
  }
}